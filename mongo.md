#MongoDB

##What is MongoDB?

  MongoDB is a document database which means that it uses documents (similar to JavaScript objects) to program. Uses embedded documents and arrays to reduce need for joins. have a dynamic schema that the documents in the same collection do not have the same set of fields or structure and common fields which means that documents could hold different types of data.

##BSON 
    Binary json mainly stores data in the binary form like JSON can simple data structures and associative arrays, but contains extensions that allow representation of data like BinData type. Uses C type data.  Meant to be efficient in storage and scan speed. It can take up more space than JSON because of prefixes and explicit array indices.

##BSON TYPES
  Strings
  object
  array
  Binary Data
  undefined
  boolean
  date

###READ More here:
  http://docs.mongodb.org/manual/reference/bson-types/

  You can access MongoDB directly through JavaScript notation. In the MongoDB shell you can use loops to help you create data and things like that.

ex.
  http://docs.mongodb.org/manual/tutorial/generate-test-data/

##Key Terminology

Collections - slightly like a collection in a SQL database only no columns and every row very with dynamic schemas in key-value pairs.

Document - the rows inside a collection. JSON data blocks stored in a memory mapped file. Only required to have a unique id that is generated by MongoDB. data that is generated by mongoDB tends to have _ before it so the id is _id.

Embedded Data - data that is stored inside of another document. Stored as an array within another document. 

Flexible schema - meaning there is no enforce way of structuring the documents but the documents tend to share a similar structure.

##Differences from SQL

  embedded docs for speed, manageability, agile development with schema-less databases, easier horizontal scalability because joins aren’t as important

###SQL
  indexes, dynamic queries and updates to name a few

##TRY MongoDB

  http://try.mongodb.org/

###Install

Mac - install the Binaries, then go to Run MongoDB and follow those steps
    http://docs.mongodb.org/manual/tutorial/install-mongodb-on-os-x/


###Commands for MongoDB
  start the database with mongod and then run the shell with mongo
  
  mongod - will start the server for your database
  mongo - is a shell to interact with it via the command line.

####Once in the shell 
  db - report the name of the current database
  show dbs - will display a list of the databases on your computer
  show collections  - will display a list of the collections that are in the db that you are in.
  use <dbname> - switch to a database
####Write operations
  db.<collectionName>.insert({object}) - to insert a new object into the collection.
  db.<collectionName>.save({object}) - this will update an existing document or will create a new one if one does not exist. (basically will run either the update or insert command especially if there is no id provided).
####update
  db.<collectionName>.update() - used to update an element/ first element if there is multiple.
  ex.
    db.myTest.update({x:2}, {x: 30}) // changes on of the documents in myTest that has the value x as 2 to x as 30.
####Remove
  db.<collectionName>.remove() - to remove inside the () put the remove criteria. It will remove all that have that condition.
  if you put db.<collectionName> .remove({}) - it will remove all the documents in the collection
  if you want to only remove on then you do db.<collectionName> .remove({condition}, 1) then it will only remove on of that condition or use an unique identifier like _id.
####Read operations
  db.<collectionName>.find() - will find documents within that collection and return as an array.
  db.<collectionName>.find({key: value}) - will find documents within that collection with that key and value and return them as an array.
  db.<collectionName>.findOne() - will return one document and if you put in a key value will return just one. (kinda like doing a limit(1) on the find)
  printjson() - will return the 
  .limit() - can be added onto the end of a find 
  .sort({key: 1}) - sort chronologically/ alphabetically (ascending)
  .sort({key: -1}) - sort reverse chronological (descending)
  db.records.find( { "user_id": { $lt: 42 } }, { "history": 0 } ) - with “history”: 0 you are excluding that value you still need to do the first part of the query 
  db.records.find( { "user_id": { $lt: 42 } }, { "history": 1 } ) - with “history”: 1 you will be getting back just history field.
      Note: you can’t mix include and exclude unless it is with _id.

###Cursors
    the Mongo shell find will always return a cursor in the shell it will only return the first 20 documents.  If you want more that 20 you can use DBQuery.shellBatchSize by doing DBQuery.shellBatchSize = #ofDocumentsYouWant.

    Cursors will close will 10 minutes of in activity to override this behavior then you need to do an .adOption(); ex. .addOption(DBQuery.Option.noTimeout)

###cursot batches
    MongoDB returns query results in batches and the size is determined by 1megabyte or 101 documents. you can override with limit and batchSize.

    When you reach the end of the batch if there are more results you can use cursor.next() to perform a getmore operation and will return one more.  If you want to see how many documents remain in the batch you can use objsLeftInBatch() to see that. if you set your information as a variable

ex.
    var myBatch = db.<collectionName>.find(); // returns 20 of the documents
    myBatch.next() // returns the next one that is not shown currently
    myBatch.objsLeftInBatch // returns the number of objects left in the batch.

###Want to find out about query optimization:
    http://docs.mongodb.org/manual/core/query-optimization/
